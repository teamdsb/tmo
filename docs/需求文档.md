# 260114采购小程序需求整理(1) 需求文档

## 1) 结构化转写（等价于把 docx 变成可读的需求清单）

### 模块一：商品与下单
- 商品菜单 & 搜索：按分类展示工业原材料，支持关键词搜索、商品详情。
- 购物车 & 下单链路：加入购物车、填写收货地址、提交“意向订单”。
- 收藏 / 常用清单：收藏常买品种，下次快速下单。

### 模块二：需求收集 & Excel 数据
- 找不到商品时的需求收集（入口要明显）：搜索不到时，客户填写“找不到的产品”（名称、规格、数量等），统一收集到后台。
- Excel 导入商品（含图片 + 多规格）：提供固定 Excel 模板，后台一键导入/更新商品菜单；导入时图片也一起导入；支持“一个商品很多规格”批量导入；举例：螺丝 A 式样的集合链接，支持按材质→长度→大小层层筛选（模板需支持这种结构或映射）。
- Excel 导出需求清单：后台按时间等条件导出“找不到的产品”列表为 Excel。

### 模块三：业务员绑定 / 客户归属
- 业务员二维码绑定：每个业务员有自己的二维码；客户扫码后自动归属到该业务员名下；后续下单算在该业务员下面。
- 客户归属转移：管理员后台可将客户从 A 业务员转给 B 业务员（离职/区域调整等）。

### 模块四：售后模块 + AI 预留
- 售后入口：小程序内有售后服务入口，客户提交售后问题/反馈。
- 售后记录管理：后台查看、标记、跟进售后记录。
- 预留 AI 接口：系统预留接口，后续接大语言模型，实现 AI + 人工客服一起回复。

### 模块五：价格体系 & 挽留客户
- 阶梯价格（零售价 + 批发价）：按数量区间展示不同单价（类似 1688）。
- “觉得贵可以聊聊”的议价入口：价格附近增加议价/留言入口，客户嫌贵可留言/联系业务员，减少流失。

### 模块六：支付功能（开发完成但暂不启用）
- 微信支付接入：后台生成支付订单并调用微信支付；支持回调更新订单状态（待支付→已支付/失败）；前端订单详情展示支付状态/记录。
- 支付开关：支付流程代码完整接好，但配置层控制“是否启用”，目前先不开启；未来开通商户号后配置并打开开关即可，无需大改流程。
- 预留支付宝方向：支付模块设计预留支付宝渠道扩展位置；后续做支付宝小程序+支付宝支付可平滑扩展。

### 模块七：整体设计 & 上线
- 整体页面设计：风格精致统一，适合发给客户看。
- 上线与使用说明：协助完成小程序上线配置，提供简单使用说明，并支持一段时间小问题调整。

### 文档末尾追加需求（新增）
- 订单追踪：面向“下单人”和“采销员”；发货成功后采销员回传单号给下单人；最好也要 Excel 批量回传功能。
- 下单人批量导入（Excel）并批量/一键加购：下单人一次采购 50 个不同物品，逐个搜索太麻烦；导入 Excel 后希望批量/一键加购；若因规格不清导致无法一键加购，则“唯一且确定”的条目一键加购，其余条目进入需要用户确认规格的交互（文档附示意并说明可优化呈现方式，目标是降低申购人工作量）。

## 2) 业务意图解读（交付的产品形态）
- 不是“纯电商下单”小程序，而是工业采购场景的“目录 + 意向下单 + 人工撮合”系统。
- 核心成交链路是“意向订单”：客户下单更像提交采购需求，后续可能由业务员跟进报价、协调货源，再决定是否进入支付/发货。
- 业务员是关键角色：二维码绑定把客户与业务员强绑定，议价入口强调联系业务员，强调把线下服务能力嵌入系统。
- Excel 是系统的生产力工具：商品导入（含图片、多规格）、需求清单导出、运单号批量回传、下单人批量导入加购，均为高频效率需求。
- 人工客服为必配角色，初期放宽权限以降低客服压力，后续按需要收紧。

## 3) 关键业务流程（用户旅程）

### 3.1 客户下单主流程（小程序）
- 分类/搜索 → 商品详情 → 加入购物车
- 填写收货地址 → 提交意向订单
- 认为价格高 → 通过议价入口留言/联系业务员
- 找不到商品 → 提交“找不到的产品”需求（入口显著）
- 下单后 → 查看订单追踪（运单号来自采销员回传）

### 3.2 业务员绑定流程（小程序进入点）
- 客户扫码业务员二维码 → 系统把客户归属到业务员名下 → 以后所有下单计入该业务员

### 3.3 商品与需求的数据闭环（后台）
- 商品：Excel 模板 → 导入/更新商品菜单（含图片、多规格、集合链接/层级筛选）
- 需求：前台“找不到的产品”提交 → 后台按条件导出 Excel → 便于统计/转发供应商

### 3.4 售后闭环（前台提交 + 后台跟进 + AI 预留）
- 客户提交售后 → 后台查看/标记/跟进 → 后续可接 AI 与人工共同回复

### 3.5 支付（已实现但默认关闭的可选分支）
- 生成支付订单 → 微信支付 → 回调更新状态 → 前端展示支付状态/记录
- 支付开关控制是否启用，未来开通商户号后可直接启用
- 架构层预留支付宝渠道扩展位

### 3.6 新增：订单追踪 & 运单号批量回传
- 采销员发货成功 → 回传运单号 → 下单人可在订单追踪看到
- 支持 Excel 批量回传能力

### 3.7 新增：下单人批量导入加购（确定的自动，不确定的引导确认）
- 下单人上传 Excel（50 个不同物品）→ 系统尝试匹配商品/规格
- 唯一确定的行直接加购
- 不确定的行进入确认界面（可优化呈现方式，目标是降低申购人工作量）

## 4) 关键数据对象（用于后端/数据库建模）
- 商品分类、商品（含详情/图片）、规格/多规格层级（材质/长度/大小等）、集合链接/分组
- 阶梯价（按数量区间的多价位）
- 收藏/常用清单
- 购物车、收货地址、意向订单、订单明细
- “找不到的产品”需求单（名称/规格/数量/备注/时间等）
- 业务员（二维码）、客户、归属关系、归属转移记录
- 售后工单/记录、跟进状态、对话消息（为 AI + 人工预留）
- 支付订单、支付记录、支付状态（开关默认关闭）
- 物流/运单号追踪记录、采销员回传记录（含 Excel 批量回传任务）
- 下单人 Excel 批量导入任务、匹配结果（确定/不确定）、确认操作记录

## 5) 已确认项（本轮确认）
- 客户归属绑定仅首次扫码生效，后续归属调整由管理员转移完成。
- 议价/询价采用线程式对话（类似售后消息），支持多轮沟通。
- 订单追踪仅展示运单号，可选承运商与发货时间；回传为追加/合并模式。
- 商品图片导入支持 Excel URL 或 imagesZip + imageBaseUrl 方案。
- 订单状态机保持现有枚举：SUBMITTED、CONFIRMED、PAY_PENDING、PAID、PAY_FAILED、SHIPPED、DELIVERED、CANCELLED、CLOSED。
- 规格层级表达保留 `filterDimensions[]` + `attributes{}` 方案。
- 批量导入一键加购匹配规则：优先 SKU code/ID；否则 name+attributes 全量匹配。

## 6) 待确认/开放问题（不做默认假设）
- 意向订单提交后如何处理：是否需要“业务员确认/报价/改价/拆单”的后台流程？
- 规格层级筛选的表达方式：螺丝示例是“材质→长度→大小”的多级筛选与“集合链接”，决定 SKU/属性模型、前台筛选 UI、以及 Excel 模板字段结构。
- 图片随 Excel 导入的存储与引用：图片来源是外链 URL、压缩包同传、还是表格内嵌对象？
- 客户归属的覆盖规则：客户重复扫码别人的二维码怎么办？允许覆盖还是只能管理员转移？
- 议价入口的承接方式：留言表单、IM，还是跳转联系（企业微信/电话）？
- 订单追踪的范围：仅展示运单号？是否需要承运商、物流轨迹查询？
- 批量导入一键加购的匹配策略：唯一确定的判定标准（商品编码？名称+规格完全匹配？）如何定义？
- 支付虽关闭但需完整可启用：订单状态机、支付记录展示、失败重试/重复回调幂等等应如何规范？
